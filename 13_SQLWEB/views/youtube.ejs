<div class="container py-4">

    <div class="d-flex justify-content-between align-items-center mb-3">
        <h2 class="mb-0">YouTube Search</h2>
        <a class="btn btn-outline-secondary btn-sm" href="/">Back to Home</a>
    </div>

    <!-- Search -->
    <form method="get" action="/youtube" class="row g-2 mb-3">
        <div class="col-12 col-md-9">
            <input type="text" class="form-control" name="q" value="<%= q %>" placeholder="Search YouTube..."
                required />
        </div>
        <div class="col-12 col-md-3 d-grid">
            <button type="submit" class="btn btn-primary">Search</button>
        </div>
    </form>

    <!-- Error -->
    <% if (error) { %>
        <div class="alert alert-danger">
            <strong>Error:</strong>
            <%= error %>
        </div>
        <% } %>

            <!-- Results -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0">Results</h5>
                </div>
                <div class="card-body">
                    <% if (!results || results.length===0) { %>
                        <p class="text-muted mb-0">No results yet. Try searching for something.</p>
                        <% } else { %>
                            <div class="row g-3">
                                <% results.forEach(r=> { %>
                                    <div class="col-12 col-md-6 col-lg-4">
                                        <div class="card h-100">
                                            <img src="<%= r.thumbnailUrl %>" class="card-img-top" alt="thumbnail">
                                            <div class="card-body">
                                                <h6 class="card-title">
                                                    <%= r.title %>
                                                </h6>

                                                <!-- Watch -->
                                                <a href="https://www.youtube.com/watch?v=<%= r.videoId %>"
                                                    target="_blank" class="btn btn-outline-primary btn-sm w-100 mt-2">
                                                    ▶ Watch
                                                </a>

                                                <!-- Add to favorites -->
                                                <form method="post" action="/favorites/add" class="mt-2">
                                                    <input type="hidden" name="videoId" value="<%= r.videoId %>">
                                                    <input type="hidden" name="title" value="<%= r.title %>">
                                                    <input type="hidden" name="thumbnailUrl"
                                                        value="<%= r.thumbnailUrl %>">
                                                    <input type="hidden" name="q" value="<%= q %>">
                                                    <button type="submit" class="btn btn-success btn-sm w-100">
                                                        Add to favorites
                                                    </button>
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                    <% }) %>
                            </div>
                            <% } %>
                </div>
            </div>

            <!-- Favorites -->
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">My Favorites</h5>
                </div>
                <div class="card-body">
                    <% if (!favorites || favorites.length===0) { %>
                        <p class="text-muted mb-0">No favorites yet.</p>
                        <% } else { %>
                            <div class="row g-3">
                                <% favorites.forEach(f=> { %>
                                    <div class="col-12 col-md-6 col-lg-4">
                                        <div class="card h-100">
                                            <img src="<%= f.thumbnailUrl %>" class="card-img-top" alt="thumbnail">
                                            <div class="card-body">
                                                <h6 class="card-title">
                                                    <%= f.title %>
                                                </h6>

                                                <!-- Watch -->
                                                <a href="https://www.youtube.com/watch?v=<%= f.videoId %>"
                                                    target="_blank" class="btn btn-outline-primary btn-sm w-100 mt-2">
                                                    ▶ Watch
                                                </a>

                                                <!-- Delete -->
                                                <form method="post" action="/favorites/<%= f.id %>/delete" class="mt-2">
                                                    <input type="hidden" name="q" value="<%= q %>">
                                                    <button type="submit" class="btn btn-danger btn-sm w-100">
                                                        Delete
                                                    </button>
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                    <% }) %>
                            </div>
                            <% } %>
                </div>
            </div>

</div>